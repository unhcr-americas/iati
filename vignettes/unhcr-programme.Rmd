---
title: "UNHCR Programme"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{unhcr-programme}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(iati)
```

<!-- WARNING - This vignette is generated by {fusen} from dev/dev_unhcr_programme.Rmd: do not edit by hand -->

# Using `iati::dataResult`

## show_indicators

    
 *  How much __indicators__ relate to target or baseline  - or acceptable global standard green threshold (for outcome indicators after 2022)- ?
 

  

```{r example-show_indicators, message = FALSE, warning = FALSE, fig.retina = 2, fig.width = 8, fig.align = "center", out.width = "90%"}
show_indicators(year = 2022,  
             ctr_name = "Brazil",
             result_type_name = "Outcome",
             type = "deviation"
             )
show_indicators(year = 2022,  
             ctr_name = "Brazil",
             result_type_name = "Outcome",
             type = "progress"
             )
show_indicators(year = 2022,  
             ctr_name = "Brazil",
             result_type_name = "Outcome",
             type = "gap"
             )
show_indicators(year = 2022,  
             ctr_name = "Brazil",
             result_type_name = "Impact",
             type = "deviation"
             )
show_indicators(year = 2022,  
             ctr_name = "Brazil",
             result_type_name = "Impact",
             type = "progress"
             )
show_indicators(year = 2019,  
             ctr_name = "Brazil",
             result_type_name = "Output",
             type = "deviation"
             )
show_indicators(year = 2019,  
             ctr_name = "Brazil",
              result_type_name = "Output",
             type = "progress"
             )
```

  

## show_indicators_time

     
 

  

```{r example-show_indicators_time, message = FALSE, warning = FALSE, fig.retina = 2, fig.width = 8, fig.align = "center", out.width = "90%"}
show_indicators_time(year = 2020,  
             ctr_name = "Brazil",
              result_type_name = "Outcome",
             type = "deviation"
             )
show_indicators_time(year =  2020, 
             ctr_name = "Brazil",
              result_type_name = "Outcome",
             type = "progress"
             )
show_indicators_time(year =  2020, 
             ctr_name = "Brazil",
              result_type_name = "Outcome",
             type = "gap"
             )
show_indicators_time(year =  2020, 
             ctr_name = "Brazil",
              result_type_name = "Impact",
             type = "deviation"
             )
show_indicators_time(year =  2020, 
             ctr_name = "Brazil",
              result_type_name = "Impact",
             type = "progress"
             )
show_indicators_time(year =  2020,  
             ctr_name = "Brazil",
              result_type_name = "Output",
             type = "deviation"
             )
show_indicators_time(year =  2020, 
             ctr_name = "Brazil",
              result_type_name = "Output",
             type = "progress"
             )
```

  

  


# Using `iati::dataSector`

## show_sectors

 *  What are the __most funded sectors__ per country (Expenditure evolution per impact /outcome area)?  
    

  

```{r example-show_sectors, message = FALSE, warning = FALSE, fig.retina = 2, fig.width = 8, fig.asp = 0.618, fig.align = "center", out.width = "90%"}
knitr::kable( iati::dataSector |> 
                dplyr::select( sector_vocabulary_name, sector_vocabulary_description) |>
                dplyr::distinct() |>
                dplyr::filter(!(is.na(sector_vocabulary_name))))
show_sectors(
  year =  c(2020, 2021, 2022), 
  ctr_name = "Brazil",
  sector_vocabulary_name = "Reporting Organisation")
show_sectors(
  year = 2022, 
  ctr_name = "Brazil",
  sector_vocabulary_name = "Reporting Organisation 2")
show_sectors(
  year = c(2020, 2021, 2022),  
  ctr_name = "Brazil",
  sector_vocabulary_name = "Reporting Organisation 2")
show_sectors(
  year = c(2017,2018,2019,2020,2021, 2022), 
  ctr_name = "Brazil",
  sector_vocabulary_name = "Humanitarian Global Clusters (Inter-Agency Standing Committee)")
show_sectors(
  year = c(2017,2018,2019,2020,2021, 2022), 
  ctr_name = "Brazil",
  sector_vocabulary_name = "OECD DAC CRS Purpose Codes (5 digit)")
```

  

## show_goal_sdg

    

  

```{r example-show_goal_sdg, message = FALSE, warning = FALSE, fig.retina = 2, fig.width = 8, fig.align = "center", out.width = "90%"}
show_goal_sdg(year =  c(  2020, 2021, 2022), 
             ctr_name = "Brazil")
```

  

  


## show_outcome_rbm

    

  

```{r example-show_outcome_rbm, message = FALSE, warning = FALSE, fig.retina = 2, fig.width = 8, fig.align = "center", out.width = "90%"}
show_outcome_rbm( year =  c(  2020, 2021, 2022), 
             ctr_name = "Brazil")
```

  

     

## show_outcome_result

    

  

```{r example-show_outcome_result, message = FALSE, warning = FALSE, fig.retina = 2, fig.width = 9, fig.asp = 0.618, fig.align = "center", out.width = "90%"}
show_outcome_result(year =  c(  2020, 2021, 2022), 
             ctr_name = "Brazil",
             outcome = "OA2: Status Determination")
show_outcome_result(year =  c(  2020, 2021, 2022), 
             ctr_name = "Brazil",
             outcome = "OA9: Sustainable Housing and Settlements")
show_outcome_result(year =  c(  2020, 2021, 2022), 
             ctr_name = "Brazil",
             outcome = "OA8: Well-Being and Basic Needs")
show_outcome_result(year =  c(  2020, 2021, 2022), 
             ctr_name = "Brazil",
             outcome = "OA4: Sexual and Gender-based Violence")
```

  

   

## compare_resource_result

    

  

```{r example-compare_resource_result, message = FALSE, warning = FALSE, fig.retina = 2, fig.width = 12, fig.asp = 0.618, fig.align = "center", out.width = "90%"}
# See a list of indicators per area of work
list_indic <- iati::mapping_indicator |> 
                 janitor::clean_names() |>
                 dplyr::filter( results_level =="Outcome") |>
                 dplyr::left_join(iati::mapping_result |> 
                                    dplyr::select(sector_rbm, area_id) |>
                                    dplyr::distinct(), by = c("area_id")) |>
                 dplyr::select(area_id, sector_rbm, indicator)
knitr::kable(list_indic)  

compare_resource_result(year =   2022, 
                        show_baseline = TRUE,
                        show_target = TRUE,
      indicator = "13.2. Proportion of PoC who self-report positive changes in their income compared to previous year.",
      outcome = "OA8: Well-Being and Basic Needs")

compare_resource_result(year =   2022, 
       ctr_name = "Costa Rica",
       indicator = "13.2. Proportion of PoC who self-report positive changes in their income compared to previous year.",
       outcome = "OA8: Well-Being and Basic Needs")


compare_resource_result(year =   2022, 
       pop_type = "Refugees and Asylum-seekers",
       indicator = "13.2. Proportion of PoC who self-report positive changes in their income compared to previous year.",
       outcome = "OA8: Well-Being and Basic Needs")
```

  

  


# Using `iati::dataBudget`

## show_expenditure

 *  How much __expenditures compare to the initial budget__ (potentially weighted by # )?   
    

  

```{r example-show_expenditure, message = FALSE, warning = FALSE, fig.retina = 2, fig.width = 8, fig.asp = 0.618, fig.align = "center", out.width = "90%"}
show_expenditure(year = c(2018, 2019,2020, 2021, 2022, 2023), 
             ctr_name = "Brazil")

show_expenditure(year = c(2018, 2019,2020, 2021, 2022, 2023), 
             ctr_name = "Brazil",
             weight_by = c("refugees", "oip"))


show_expenditure(year = c(2018, 2019,2020, 2021, 2022, 2023),
             ctr_name = "Argentina",
             weight_by =  "all" )

```

  

## show_budget_gap

    

  

```{r example-show_budget_gap, message = FALSE, warning = FALSE, fig.retina = 2, fig.width = 8, fig.asp = 0.618, fig.align = "center", out.width = "90%"}
show_budget_gap(year = c(2018, 2019,2020, 2021, 2022, 2023), 
             ctr_name = "Brazil")
show_budget_gap(year = c(2018, 2019,2020, 2021, 2022, 2023), 
             ctr_name = "Brazil",
             weight_by = c("refugees", "oip"))
```

  

  


# Using  `iati::dataTransaction`

## Show donors 

 
 *  Who are the __main donors by country__ in terms of transaction?   


```{r examples-show_donors, message = FALSE, warning = FALSE, fig.retina = 2, fig.width = 8, fig.asp = 0.618, fig.align = "center", out.width = "90%"}
knitr::kable(iati::dataTransaction |>
                dplyr::select( transaction_type_name, transaction_type_description) |>
                dplyr::distinct() )
show_donors(year = 2022,
           programme_lab = "The Americas",
           transaction_type_name = "Incoming Commitment" )
show_donors(year = c(2018, 2019,2020, 2021, 2022, 2023),
           ctr_name = "Brazil",
           transaction_type_name = "Incoming Commitment" )
show_donors(year = c(2018, 2019,2020, 2021, 2022, 2023),
           programme_lab = "Brazil",
           transaction_type_name = "Disbursement" )
show_donors(year = c(2018, 2019,2020, 2021, 2022, 2023),
           programme_lab = "Brazil",
           transaction_type_name = "Expenditure" )
```

## show_top_donors

    

  

```{r example-show_top_donors, message = FALSE, warning = FALSE, fig.retina = 2, fig.width = 8, fig.asp = 0.618, fig.align = "center", out.width = "90%"}
show_top_donors(year = 2022,
           ctr_name = "Brazil", 
           top_n = 5)
show_top_donors(year = 2020,
           ctr_name = "Brazil", 
           top_n = 10)
```

  

  




## show_earmarking

 *  Whatâ€™s the breakdown of __Earmarking Type__ (Un-earmarked, Tightly earmarked, etc.) from Donor Funds by Year?  
 
    

  

```{r example-show_earmarking, message = FALSE, warning = FALSE, fig.retina = 2, fig.width = 8, fig.asp = 0.618, fig.align = "center", out.width = "90%"}
knitr::kable(iati::dataTransaction |>
                dplyr::select(earmarking_name, earmarking_description)  |>
                dplyr::distinct() |>
                dplyr::filter(!(is.na(earmarking_name))))
show_earmarking(year = c(2018, 2019,2020, 2021, 2022, 2023),  
             ctr_name = "Brazil")
```

  

  


## show_contributions

    

  

```{r example-show_contributions, message = FALSE, warning = FALSE, fig.retina = 2, fig.width = 8, fig.asp = 0.618, fig.align = "center", out.width = "90%"}
knitr::kable(iati::dataTransaction |>
                dplyr::select(aid_type1_name, aid_type1_description)  |>
                dplyr::distinct() |>
                dplyr::filter(!(is.na(aid_type1_name))))
show_contributions(year = c(2018, 2019,2020, 2021, 2022, 2023), 
                   ctr_name = "Brazil") 
show_contributions(year = c(2018, 2019,2020, 2021, 2022, 2023), 
                   programme_lab = "The Americas") 
```

  

## show_transaction_flow

    

  

```{r example-show_transaction_flow}
show_transaction_flow(year = c(2020, 2021, 2022, 2023), 
                   ctr_name = "Brazil")

show_transaction_flow(year = 2023, 
                   ctr_name = "Brazil")
```

  

  

  

# Using `iati::dataParticipating_org`

## Show partnership

 
 *  How __organisations partner together__?   
 


 

```{r examples-show_partnership, message = FALSE, warning = FALSE, fig.retina = 2, fig.width = 8, fig.asp = 0.618, fig.align = "center", out.width = "90%"}
show_partnership(year = 2022,
           ctr_name = "Brazil" ) 
```

 



# Template

## template_prez

    

  

```{r example-template_prez}

## generate for one country
# iati::template_prez(year = 2022, 
#                     ctr_name = "Brazil",
#                     folder = "dev/Prez")

# ## Generate for all operation specific region
# reg <- iati::dataActivity |>
#   dplyr::select( unhcr_region) |>
#   dplyr::filter(! is.na(unhcr_region)) |>
#   dplyr::distinct() |>
#   dplyr::pull() 
# 
# thisfolder <- "dev/SMR" 
# 
# for (region in reg) { 
#       cat(paste0( region,   "\n"))
#
#       # region <- "The Americas"   
#       countries <- iati::dataActivity |>
#         dplyr::filter( unhcr_region ==  region) |>
#         dplyr::select(ctr_name) |>
#         dplyr::distinct() |>
#         dplyr::pull() 
#       
#       for ( ctr in countries) {
#         cat(paste0("Generating for ", ctr, "\n"))
#         iati::template_prez(year = 2022,
#                             ctr_name = ctr,
#                             folder =  thisfolder)  
#         }
#     }
```

  

## template_compare

    

  

```{r example-template_compare}
# iati::template_compare(year = 2022, folder = "dev/Result")
```

  

    



